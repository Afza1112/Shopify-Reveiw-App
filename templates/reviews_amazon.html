{% extends "base.html" %}
{% block content %}
<div class="amazon-reviews-box">
    <h2>Customer reviews</h2>
    <div class="amazon-summary">
        <span style="font-size:2rem;">{{ avg_rating }} out of 5</span>
        <span class="star-bar">
            {% for i in range(1,6) %}
                {% if i <= avg_rating|round(0, 'floor') %}
                    <span style="color:orange;">&#9733;</span>
                {% else %}
                    <span style="color:#ddd;">&#9733;</span>
                {% endif %}
            {% endfor %}
        </span>
        <div>{{ total_reviews }} global ratings</div>
    </div>
    <div class="star-breakdown">
        {% for i in range(5, 0, -1) %}
            <div>
                <span>{{ i }} star</span>
                <div class="star-bar-bg">
                    <div class="star-bar-fill" style="width:{{ star_perc[i] }}%"></div>
                </div>
                <span>{{ star_perc[i] }}%</span>
            </div>
        {% endfor %}
    </div>
    <h3>Reviews with images</h3>
    <div class="amazon-images-row">
        {% for review in reviews if review.image_url %}
            <img src="{{ review.image_url }}" alt="review image" style="width:120px;height:120px;object-fit:cover;margin:6px;">
        {% endfor %}
    </div>
    <h3>All Reviews</h3>
    {% for review in reviews %}
        <div class="review-item">
            <div><strong>{{ review.name or "Anonymous" }}</strong>
                <span class="star-bar">
                {% for i in range(1,6) %}
                    {% if i <= review.rating|int %}
                        <span style="color:orange;">&#9733;</span>
                    {% else %}
                        <span style="color:#ddd;">&#9733;</span>
                    {% endif %}
                {% endfor %}
                </span>
            </div>
            <div>{{ review.text }}</div>
            {% if review.image_url %}
                <img src="{{ review.image_url }}" alt="review image" style="width:80px;">
            {% endif %}
        </div>
    {% endfor %}
</div>
{% endblock %}
